**Faster Reinforcement Learning**  
   
Fine-tuning large language models via reinforcement learning is computationally expensive, but researchers found a way to streamline the process.
 
**What’s new:** Qinsi Wang and colleagues at UC Berkeley and Duke University developed [GAIN-RL](https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/VW9ZvY9bzMNXW7q0pSP2nP0M1W78L4Hk5CSHfJN1HNy-b3qgz0W7lCdLW6lZ3nVW8D3D2r8Jzb7SW8Vzr8v4y3qxlW60gNHd1vb4xdW89-0Yn7kBWFVN8H6zvskvG5BVXWrTc8lQTt1W3H_s8R87019bW8ld5fP72GxtZW5RT0m22C6bshN3wk9sbt_PqKW7nlZLK3skkRsVmyKfT6Sjxv6W2n-v771X2jbVVZfpkC7q-P95N6Xq_P8jx1MbN2fJlW96gFSBW3JQXF75gfPNJW6Vm8n26MG5mqW2zsQjR4ZR8sLW6Ph1Xd4FDZf9W5Fth0v6QQ7wxW3NC6Ff5CZgBKW6SpMNV5KgqFMW8x7v288Vv8TMf2Y3J6C04), a method that accelerates reinforcement learning fine-tuning by selecting training examples automatically based on the model’s own internal signals, specifically the angles between vector representations of tokens. The code is [available](https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/VW9ZvY9bzMNXW7q0pSP2nP0M1W78L4Hk5CSHfJN1HNy-b3qgz0W7lCdLW6lZ3mvW7zl-742DbtqYVR33VG42XvdxVJ4G-F2Hj9F3W4l35Dg6yBwXhW1rZnqx8Kj0TbW1h4N1938MbfjW7k97kt2FtXcgW858dGZ1cTxqhW3VcSZh85yXrdW3m3Flq6pLnv7W1H9xR72k5Nf3W6rDPtW1YKXJkW97NcJF2BPYHdW1kQpWb5yC1M4TFlGh8b-pvVW6s8JBv5TCLgjN6f409Bkp0_nW1fZ3T73Pz1MYW1yf-Xx8ct4YRW4J69yH1hQKllW2WLYbL1L9kmVW1rR6cq433tz9W3_WhWm2N3RrzW28bW2-1M5tt_f2VZxpP04) on GitHub.
 
**Key insight:** The cosine similarity between a model’s vector representations of input tokens governs the magnitude of gradient updates during training. Specifically, the sum of those similarities that enter a model’s classification layer, called the angle concentration, governs the magnitude of gradient updates. Examples with higher angle concentration produce larger gradient updates. The magnitude of a gradient update in turn determines the effectiveness of a given training example: The larger the update, the more the model learns. Prioritizing the most-effective examples before transitioning to less-effective ones enhances training efficiency while adding little preprocessing overhead.
 
**How it works:** The authors separately fine-tuned Qwen 2.5 1.5B, Qwen 2.5 7B, and Llama 3.2 3B using the [GRPO](https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/VW9ZvY9bzMNXW7q0pSP2nP0M1W78L4Hk5CSHfJN1HNy-b3qgz0W7lCdLW6lZ3nbW5dv6T74LhfhfW4p4Yxh5mL99hW86843J8V6L0mW2V5vrG2VS4GhW4kjBsT6wQSmMVqfC5b1ZpFjvV2l-v-5ghP-hW3lZvDW8CrgwbW62xpHn6MZz8dW6fGWph6vBsDqW3c4kCb19KQF1W3fX8Ky6H3ZHvN8sk2V5Q2h0rW6WNyJY7rfVG3W60mFtP8R-zfSVjvqx-2sfzZVW21CC-85YdyWfW7x2rZn52N76kT2k6l5ZvY_wW8m6jp37tJmrfN4V92D6H4HRmW8CYxM154W35tW64hF_64lnDjJW4Z9DXG8lH_nKdF_6MC04) reinforcement learning algorithm with examples ordered according to their angle concentration. The datasets included math problems in [GSM8K](https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/VW9ZvY9bzMNXW7q0pSP2nP0M1W78L4Hk5CSHfJN1HNy-b3qgz0W7lCdLW6lZ3lyW4VC5d04JkT8BW5s1p_h2tmSzGW66-0kc2fP2B_W1p2M8Q2D6_F3W157HD77mtKrBW7VBL_H58qVZNW3Vp19X8q1RB6W6Tr1293wM3kPW2_T7TK3qjcY_N8-dwlcw2H8RW15nCL42gR0wFW6cf3wm3TvZqsW50GB2F8kSyDsW9b6q9K6MYs_9W2Sj6wF38cy-7W3qhQkc7402CLVmC_Zp8PT0KPW7-g3YT6MDm3pW37MZN84Dx7rCW7L_M909hvt6FW2JBjNd5xfC9rW5wzh868GTLqHW4vmmtd4fJm-vW3wnMw66QMV87f6h9vqR04) and [AMC 23](https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/VW9ZvY9bzMNXW7q0pSP2nP0M1W78L4Hk5CSHfJN1HNy-v3qgz0W7Y8-PT6lZ3pQW3WPYH75YRnw8W8NXylY2vpMvLW4wR5mm76qn0HW6MP2Tq5_cCGHW47DkzY1B57B7W6N8ZR74T7wdrW4jz2qm7lW9JdW7_WPb04BxNZQW2MnkNf8NmPSRW5QfxL1546zftW7DY_kR55XKK1W7-PN541tGslXVytnNv11PyFvW8ycpy-2by7x7W7k6N771xqgC8N6KsK7Mg162hVfd1Sv3K2BqxW4J0-9j60CsGVW214t2980tCT_W8hLYGW5knTbZW64zBtp1sP9_zVMYbx-8hh9QJW3bGcym92rWSkW5FhRmf7NvcnXW8jYfxd6DRnZ6W4M4YgG1N3Rykf8zBlKR04), and coding problems in [LiveCodeBench](https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/VW9ZvY9bzMNXW7q0pSP2nP0M1W78L4Hk5CSHfJN1HNy-b3qgz0W7lCdLW6lZ3lkW4nlY7k4hVdJ-W1vj8w_42d5B5W8wZ-fB7vckNDW4G5jW67qHbbCW1SWy3g2X79WzV9fvCL3V8wZpW1L5qkV3n8tjBW8N-LjZ52Z9xNW3j-cKP2ffkvLW2Qfdrt6_jWxcW2Psj0Q24Gk73W8M5cbt5YRfbHW18mDvd4DP8L4W7SfCzT4tDDQRN1fyDfP9-LLzVwxCF66rgRMZW6RgqHT16Rp7yW2tlw227PwYRNN3_4vKRbK8bcW2PPhZF32kBMRW5f4-mP3MzjPKW1t02bQ95P4MqW56YWTM2gw8mqW5bGh-k28Ybjff64FLxR04) and [HumanEval+](https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/VW9ZvY9bzMNXW7q0pSP2nP0M1W78L4Hk5CSHfJN1HNy-b3qgz0W7lCdLW6lZ3ntW8_fp-b6Jh9xBW1fd_Fr3phNJqW4Wc3Vy95l9s8W75FBdl6CQTc9W6qkWT68D03KLW3D34cR2kFrSYW358Cvl4vC0ZhW7qH3DG5HHFLFN8Mv1f_F16vDW861NbD1fm3CWW57X2H53xQ5kxW1ds8lz2HS5g8N3bzN8pQnPkFW72XTr0986c9WW7NGJ_h4Zz3nlN73S5FhwhfcWW4T2F4x8YCvbWW6dM0X574-r5lW6LGjPG7tmTyWVvVjkx7QP9CbW53-XJ44qfC7GW1ZZ3cd7sXjZFW3217Rr2mCFR1W5CdM5586tQ9Lf4JzLQl04).

- Given a training set, the authors calculated the angle concentration of each example by performing a single forward pass on the entire dataset. They sorted examples from highest to lowest angle concentration.
- They fine-tuned the models, focusing first on examples with the highest angle concentrations and shifting toward lower angle concentrations as training progressed. They tracked the models’ learning according to accuracy and the angle concentration on each batch of data. They shifted the focus more toward less-effective examples as the model learned and shifted less when it struggled.
- They continued training for 200 epochs.

**Results:** The authors compared models that were fine-tuned using GAIN-RL with counterparts that used GRPO performed on randomly ordered examples. GAIN-RL generally accelerated learning by a factor of 2.5.

- Whether the task involved math or coding, GAIN-RL took 70 to 80 training epochs to match the performance of fine-tuning using typical GRPO for 200 epochs.
- For instance, on GSM8K, Qwen 2.5 Math Instruct 7B after GAIN-RL fine-tuning achieved 92.0 percent accuracy after 70 epochs. The version fine-tuned on typical GRPO needed 200 epochs to reach the same performance.

**Why it matters:** Many strategies for ordering training examples rely on external, often expensive heuristics based on their difficulty, for example judgments by human annotators or a proprietary LLM. By using a simple signal generated by the model itself, this method provides a direct and efficient way to identify the most effective examples, making reinforcement learning much faster.
 
**We’re thinking:** Ordering training examples is much older than applying reinforcement learning to fine-tuning large language models. Applying earlier methods to more recent approaches holds many advances in machine learning!
 \> From \<[https://mail.google.com/mail/u/0/#inbox/FMfcgzQcpwlxSmbvZFmHHBqwHhGbfbbc](https://mail.google.com/mail/u/0/#inbox/FMfcgzQcpwlxSmbvZFmHHBqwHhGbfbbc)\>