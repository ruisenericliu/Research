**Hallucination Detector**  
Large language models can produce output that’s convincing but false. Researchers proposed a way to identify such hallucinations.   
**What’s new:** Sebastian Farquhar, Jannik Kossen, Lorenz Kuhn, and Yarin Gal at University of Oxford published a [method](https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/MWrnGkzZDHxW6K4_Bn1RfbQ3W4PtzZh5hDrxxN5t-nks3qgyTW7lCdLW6lZ3mkW2q62Jp1jdBRtVKFqvT3zmH1WW8J4Cz33JR40YW3-hB458xXbYTW6D6rD_1ssCh1W5bb__782DchMW807vXk3vvgD1VLWNjJ3XVcyFW2gyf1Z5PDJgKVylS2Z1CyMkfW2QlJQc4_cGb3W11dSJZ3QCbh7W1TV6fN3KlyKWW1qpLfR5nF94YVNpxSG6k4hR4W8k6gJy1TL2TYW6Hb3Y_18cpK_N82W8D8yW_BWW7rhX_q84ZRJ2W2z5Cvx6CcslcW1R0VLz3PhLfDN32Cv2DC6rm2VrqrX94X-nQKW6trmMC77_xl_f8y47VP04) that indicates whether a large language model (LLM) is likely to have hallucinated its output.  
**Key insight:** One way to estimate whether an LLM is hallucinating is to calculate the degree of uncertainty, or entropy, in its output based on the probability of each generated token in the output sequences. The higher the entropy, the more likely the output was hallucinated. However, this approach is flawed: Even if the model mostly generates outputs with a uniform meaning, the entropy of the outputs can still be high, since the same meaning can be phrased in many different ways. A better approach is to calculate entropy based on the distribution of generated meanings instead of generated sequences of words. Given a particular input, the more likely a model is to respond by generating outputs with a variety of meanings, the more likely that a response to that input is a hallucination.   
**How it works:** The authors generated answers to five [open-ended](https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/MWrnGkzZDHxW6K4_Bn1RfbQ3W4PtzZh5hDrxxN5t-nks3qgyTW7lCdLW6lZ3nXW8p-KpJ8mdYgsW4Gw2-r8BNB4cVVj2WG8Mh8HWV65J076J1MGNW7xlVdf62zNmhN7CpYQvW4W2gM5g5kTzj5mRW15mPkx2HGNlcW3DHpzR7vWJtQW68h8sj75hgRtW5rT3_p3yy_wpW7H8cjj3y3HjRW51M32H2tQs9pW4Qw8qk1RSL2YW8g1_DR1WHLW5W5ZZ0TS4YrPKlVvtrK351-nVdW4t4Jxv75m5wQW76hVgH6MF6XNV_Bb5M7xLkKSV4S3pV2p1pn4W4wC56x3MTv6WW3YmdxJ36DSb7VvrDgF7cby-Rf4_t62n04) [question](https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/MWrnGkzZDHxW6K4_Bn1RfbQ3W4PtzZh5hDrxxN5t-nks3qgyTW7lCdLW6lZ3lNVPq7_L8NlR5BN1yndrDdLpSGW3KB-TN6vkYtfW1dcbpC5v8P4NW8LCpSY2ZV0wWW95S6QS73BWYWN9bX-5r34TprW50nHj45XfKPcW8ck8ZN86Wzb6W7KQ72T50LtlCN9fqS3g4bjGdW78RvjV297GRlW6hkZlr3Z4VMdW3ZGHLn6nS6XCW68-pPC1Zyr1QW2_27Kr7vpHyQW2-DwDn32532MW1JTX6n3GX3YxW3Cq9Qz6xqjK7N5g0TtXL1JY9W1vg-rh4ptFTlW1lPtd15V7LF_W7_fFMJ7xXvqPW4NkC_b7HNvvTf3h-0P-04)-[and](https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/MWrnGkzZDHxW6K4_Bn1RfbQ3W4PtzZh5hDrxxN5t-nkM3qgyTW7Y8-PT6lZ3l4W5BvDnL3KtNtQW84XwPb4cyr1bW7_9Dr72XgVVXW5FDY9r1nNt3gW1T8h_D7Qjm3qW2yTrnz2gTlbLW81Kpv97spSQJW6yjXxN1Txsd4W1PW4LK8c8z5hVlpHrv97h2d5W25nTdw4Nv_m8W9hZ6678Pb5rhW4T6B6p7zYRzZW44dgQl8KcDTDV-bNpm24JyffW8njx7j25clGZW4q-Pc63hT66DW49NTWr1TM6YsW7_3SBH1-7SBVW319Thz12SNCPW4nnQJl8F1fmNVq1DlM56j3j8W72QzrF3b80H4Vv2LfW1WjCp2W4z5JHc4jqnkCW2DjKK59b8cWpdp2Xtq04)-[answer](https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/MWrnGkzZDHxW6K4_Bn1RfbQ3W4PtzZh5hDrxxN5t-nk83qgyTW6N1vHY6lZ3mdW5t3b9x5q-glyW6MQpTr58ncbxW6HB4rp8Gl0N6V7GThN3SM557W12v5066HLVdxV8c34q4dXrV-W8v2cFs4d3TX-W40bK_K21YvdKW6vKztg3kFnr6W8C3tgt7KBr4PW6j3jYy2B9D9rW6NWLJK5WrhcPVz1HPJ3Kw8ryW362mrw8mt-ldN8rY1XyM9-lNW7QxSPB5wWvjTMrbQSNhlC-RW7Yn4V76mvMhWVfDj914lGP6DW20VcmN2qMsdnW2yczv37p-KCQVV5Wjh3q_Rjdf21HmG204) [datasets](https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/MWrnGkzZDHxW6K4_Bn1RfbQ3W4PtzZh5hDrxxN5t-nks3qgyTW7lCdLW6lZ3kPW7J0cK_2lxJxZW7Lwrjb1lZXq_N98zTMHWBHSkW3mR-6X52SSQbW46wjw56VbnSrW7QbRjL6BPBr_N3JcWpV8H3QRW8fX8pJ1GXTh3W69nsgb5sKq0WW22zM985dlS_jW36XLnv1k4GxGN7t8W7xNGJl8W53KrJH2-gp28W88v7xl585VMjW3TrlNX3pDg7cW4zPKCV7rL6z4VXKf6k6Hch3-W5rhXYF8gzfrSW5l7nCX7cnKjyW9f8GmM401hXHW1GwFdr33Fm8dW4f9z0n4yt-vSW62Xg7R9gw5r9W67byKj8-HkL0f9g_C_v04) using various sizes of Falcon, LLaMA 2-chat, and Mistral. They checked the answers for hallucinations using the following method:

- Given a question, the model generated 10 answers.
- The authors clustered the answers based on their meanings. They judged two answers to have the same meaning if GPT-3.5 judged that the first followed logically from the second and vice versa.
- They computed the probabilities that the model would generate an answer in each cluster. Then they computed the entropy using those probabilities; that is, they calculated the model’s uncertainty in the meanings of its generated answers. 
- All answers to a given question were considered to have been hallucinated if the computed entropy exceeded a threshold.

**Results:** The authors measured the classification performance of their method using AUROC, a score between .5 (the classifier is uninformative) and 1 (the classifier is perfect). On average, across all five datasets and six models, the authors’ method achieved .790 AUROC while the baseline entropy achieved .691 AUROC and the [P(True)](https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/MWrnGkzZDHxW6K4_Bn1RfbQ3W4PtzZh5hDrxxN5t-nk83qgyTW6N1vHY6lZ3kGW8qPKxY2fbfBqW5XG7h76--fHDW6hkY739fJRyfW3HC2Kv6mJjJDVlS4yt2qGfZQW93sbJP5BnYTLW2CVNym4LRfhPW55Ghzq8zWZWfV-2Gr12jVfP_W6LGvxj1vB855W5zvBv191QVpPW2dkydP4MZ-6dW5G1qRk8Pc--8W2wvqnz350xpYW5XQxWD8xp9VdW8-TLvc4ZcHs4W171Yf06s3kKdN416lChR0C7mW3jNngH1rYpDnW2m3RRR1vY0y0W99r9xd6023JtW17DJp-1Jl314dDvTvd04) method achieved .698 AUROC. P(True) asks the model (i) to generate up to 20 answers and (ii) whether, given those answers, the one with the highest probability of having been generated is true or false.  
**Yes, but:** The authors’ method fails to detect hallucinations if a model consistently generates wrong answers.  
**Behind the news:** Hallucinations can be a major obstacle to deploying generative AI applications, particularly in fields like medicine or law where missteps can result in injury. One study published earlier this year [found](https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/MWrnGkzZDHxW6K4_Bn1RfbQ3W4PtzZh5hDrxxN5t-nll3qgyTW95jsWP6lZ3kQW5TSLzp7kg_ZgW9hN0Wh6lrW4QW6vVlVY2Xj8H2W5Kgpf18f7vF0W4GMcls7wzQ8xN8xmwFQZDBYBW1FcgcZ67H0Z0VC5CNB2F76wfN2rYNvNTCFNlVN7KcZ8yc51_W3v4D-c7LwkNLW4ZH2Gm25gMYDW71m5TD3b9_5pV32qfc8VjqrYVYQ43t46RNzDW3b2QMh8tyTtxW7b0GY18DP1sQW5HpLPw4XBGxQW4NvqF08fs6XLW2LVdph5p0ffXW60-91B3R6dNtW1RvKq379LV7RW4n5xkS7bdYwGW1tjC-n588h7zW2ls_rr3hqN1NW107HGN95y91cW79cYpQ90R1QDW4Kv1fX6X6ZSPV3ttX52HZcvdW7kg6591K2B4Sf2dXVSg04) that three generative legal tools produced at least partially incorrect or incomplete information in response to at least one out of every six prompts. For example, given the prompt, “Are the deadlines established by the bankruptcy rules for objecting to discharge jurisdictional,” one model cited a nonexistent rule: “[A] paragraph from the Federal Rules of Bankruptcy Procedure, Rule 4007 states that the deadlines set by bankruptcy rules governing the filing of dischargeability complaints are jurisdictional.”  
**Why it matters:** Effective detection of hallucinations not only fosters trust in users — and consequently rising adoption — but also enables researchers to determine common circumstances in which hallucinations occur, helping them to address the problem in future models.  
**We’re thinking:** Effective detection of hallucinations not only fosters trust in users — and thus potentially greater adoption — but also enables researchers to determine circumstances in which they occur, so they can be reduced in future models.
 \> From \<[https://mail.google.com/mail/u/0/#inbox/FMfcgzQVxbqLJwzgXmwXWLBckbmmZSGf](https://mail.google.com/mail/u/0/#inbox/FMfcgzQVxbqLJwzgXmwXWLBckbmmZSGf)\>